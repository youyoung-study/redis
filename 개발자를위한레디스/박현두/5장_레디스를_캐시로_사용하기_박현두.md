### 캐시란?

- 데이터의 원본보다 더 빠르고 효율적으로 액세스 할 수 있는 임시 데이터를 의미함.
    
    아래와 같은 경우 캐시를 사용하는 것이 좋다.
    
    1. 원본 데이터 저장소에서 원하는 데이터를 찾기 위해 검색하는 시간이 오래 걸리거나, 매번 계산을 통해 데이터를 가져와야하는 경우
    2. 캐시에서 가져오는게 원본보다 빠를 경우
    3. 조회는 빈번하나 잘 변하지 않는 경우

### 캐시로서의 레디스

- 특징
    1. 인메모리 데이터 저장소여서 빠르다.
    2. 고가용성을 가지고 있다. (클러스터링, 센티널  기능을 제공한다)

### 캐싱 전략

- 읽기 전략
    1. look aside
- 쓰기 전략
    1. write through
    2. cache invalidation
    3. write behind

### 캐시 데이터 흐름

- 메모리 관리와 maxmemory-policy 설정
    - nodeviction
    - volatile-lru
    - allkeys-lru
    - LFU eviction
    - RANDOM eviction
- 캐시 스탬피드 현상
    - ttl
    - 선계산
    - PER 알고리즘

### 세션 스토어로서의 레디스

- 세션이란?
    
     서비스를 사용하는 클라이언트의 상태 정보를 의미한다.
    
    현재 서비스에 로그인돼 있는 클라이언트가 누구인지, 그 클라이언트가 어떤 활동을 하고 있는지 저장한다.
    

- 세션 스토어가 필요한 이유
    
    단일 웹서버일 경우에는 자체적으로 세션 스토어를 두고 관리할 수 있다.
    
    그러나 서비스가 확장되어 웹서버를 여러 대 로드밸런싱해야하는 경우, 
    
    이때 각 서버가 세션 스토어가되면 데이터의 정합성이 문제가 된다.
    
    또한 sticky session으로 구현해야하고, 이 방식은 트래픽을 분산시킬 수 없다.
    
    또 다른 방법으로는 세션을 모든 웹서버에 복제하는 all to all 방식이 있다.
    
    이 방식은 복제는 가능하나 사용자는 웹서버 한대만을 사용하는데 다른 웹서버에 모두 세션정보를 보관해야해서 불필요한 저장공간을 차지한다. 또한 불필요한 네트워크 트래픽도 발생한다.
    
    또 다른 방법은 데이터베이스 사용이 있다.
    
    이 방식은 앞선 모든 문제를 해결하지만, 세션 스토어의 응답 속도가 느려지면 클라이언트 응답속도를 느리게하고 데이터베이스에 부하를 준다.
    
    따라서 레디스를 세션 스토어로 사용하는게 좋다.
    
- 캐시와 세션의 차이
    
    레디스를 캐시로 사용할 때는 데이터베이스의 완전한 서브셋으로 사용한다.
    
    캐시는 모두 데이터베이스에 저장되어 있으며, 캐시의 데이터가 유실되더라고 해당 데이터는 데이터베이스에서 찾을 수 있다.
    
    세션으로 사용할 때는 세션 스토어에만 저장을 한다. 그 이후 세션이 종료될 대 데이터의 종료에 따라 데이터베이스에 저장할지, 삭제할지 정한다.